---
title: "はじめに：セキュリティ分析と生成AIエージェント"
emoji: "👋"
type: "tech"
topics: ["security", "LLM", "AI", "agent"]
published: false
---

この記事はアドベントカレンダー「Goで作るセキュリティ分析生成AIエージェント」の1日目です。

# はじめに

情報セキュリティ運用の現場では日々様々なアラートが発生しています。これは外部からの攻撃を示すものだけでなく、プロダクトやサービスのセキュリティ設定の不備や、新しい脆弱性情報など、セキュリティにまつわる問題のありそうな事象全般がアラートとして捉えられます。セキュリティ担当者は日々限られたリソースの中でこれに対応する必要があり、少なくない労力が必要となっています。これは本来セキュリティ担当がなすべきセキュリティ施策の検討・実施・改善などを阻害する要因の一つとなっています。

この問題を解決するアプローチの1つとして生成AIの活用が挙げられます。生成AIは2022年末のChatGPT登場から進化を続け、2025年には生成AIを利用して自律的に問題を解決する「生成AIエージェント」が台頭してきました。特にCursor、Claude Codeといったソフトウェアエンジニアリングをサポートするコーディングエージェントが着目されていますが、それ以外にも様々な用途がありえます。

今回のアドベントカレンダーでは、情報セキュリティに関する業務のなかで日々発生するアラートの対応をサポートする生成AIエージェントを実装するのが目的です。セキュリティアラートの対応は様々ですが、日々の業務で最も負荷が高いのは下記のようなタスクとなります。

- **初期分析**：そのアラートは組織にとって無視してよいか、それとも実際に影響を及ぼすのかの調査
- **発報調整**: アラート発生時にまず無視してよいものかなどを判定するための仕組みの調整。多くはルールチューニングなどがこれに該当
- **結果整理**: 大量に発生したアラートを整理して影響のあるものを洗い出す作業

これをサポートするための専用のエージェントをGo言語で構築していきます。LLM含む生成AI関連での実装で著名なのは[LangChain](https://www.langchain.com/)や[LangGraph](https://www.langchain.com/langgraph)が挙げられますが、これを利用せずにGo言語でLLMサービスのAPIのみと組み合わせて実装していきます。

# このアドベントカレンダーの目的

このアドベントカレンダーでとりあつかう「セキュリティ分析をするための生成AIエージェント」ですが、実は筆者はすでにこれを実装し、実際の運用で利用しています。

https://github.com/secmon-lab/warren

このエージェントはWebサービスとして動作してセキュリティアラートを外部システムから受け取り、Slackと連携して分析ができるような仕組みになっています。

![](https://storage.googleapis.com/zenn-user-upload/0565aea28f39-20251010.png)
_Slack上での生成エージェントとの対話によってアラートを分析している様子_

![](https://storage.googleapis.com/zenn-user-upload/d17c85295676-20251010.png)
_Webインターフェースからアラートの対応状況全体を確認_

このツールの実装をすべて追いかけても良いのですが、SlackやWeb UIの部分まで含めるとかなり複雑な構成となり25日に収まらなくなってしまいます。またUI部分は生成AIに直接関係する部分も少なくなっています。そこでこのアドベントカレンダーでは、 **生成AIによるセキュリティ分析のエージェントの実装を、最小構成で追体験していく** といった内容になっています。具体的にwarrenからSlack連携やWeb UIを取り除き、CLIベースで動く最小のエージェントを、25日後に読者が実装できるような状態を目指します。

## このアドベントカレンダーで対象とする読者

そのため、このアドベントカレンダーの狙いとする対象の読者は以下のような方々になります。

- **生成AIエージェントを自力で構築してみたい人**：今回は生成AI関連の機能については生成AIサービスのAPIを使うのみで、それ以外はフルスクラッチする形になります。これはGoに限らず他の言語で生成AIエージェントを作ってみたいという人にも参考になるのではと思います。
- **ある目的に特化した生成AIエージェントの設計・実装過程を知りたい人**：今回はセキュリティ分析をターゲットとしますが、ある目的に特化したエージェントを作成する際のアイディアをいくつか紹介できるのではと思います。
- **セキュリティ分析という領域で生成AIエージェントがどのように活用できるかを知りたい人**：情報セキュリティの分野に関わる人で、通常業務のアラート分析などに生成AIを取り入れようと考えている方にも、参考になるアイディアはあるのではと思います。

またスキルセットとしては下記を想定しています。

- 生成AIはChatGPT、Claude、GeminiなどをWebUIのような対話形式で利用したことがあり、どのような対話がｄきるかはある程度知っている
- Go言語による基本的なソフトウェア開発技法についてある程度馴染みがある

## このアドベントカレンダーで対象としない読者

一方、以下のような方がにはおそらく得られるものが無いと考えられます。

- **LLMの要素技術に関する専門知識を得たい人**: このアドベントカレンダーでは生成AI関連技術をAPIレベルで利用するところ止まりとなります。最新の研究成果や論文などの話はほぼ出てきません。
- **LLMに関する最新の情報をキャッチアップしたい人**: このアドベントカレンダーは概ね2025年中盤くらいまでの情報を元にした技術構成となっており、それ以降の最新情報を得たいという目的の人にとっては不向きです。

# 25日間で構築する生成AIエージェントの全体像

詳しくは明日以降の記事で解説しますが、今回実装する生成AIエージェントの着地点について解説しておこうと思います。

## セキュリティ分析とは

まずここでいう「セキュリティ分析」ですが、より明確化すると「セキュリティアラートの分析」となります。セキュリティアラートとはいわゆるアンチウィルスソフト、侵入検知システム、EDR (Endpoint Detection & Response)、ファイアウォールなどのようなセキュリティ監視のシステムから発報されるものだけではありません。新たに発生した脆弱性や3rd partyパッケージのサプライチェーン攻撃、内部システムの設定不備なども含めて、セキュリティ上の問題がある可能性を示唆する通知全般、ととられてもらえればと思います。

## 生成AIエージェントの機能

具体的な機能要件整理は改めてやりますが、おおよそ以下のようなセキュリティ分析の機能をもたせる予定です。生成AIに直接関係するものだけでなく、アラート管理等まで含めた機能を想定しています。

- **アラート管理機能**：セキュリティアラートを記録し、対応結果などを保存するようにします。過去の類似したアラートを抽出してそれをもとに分析できるようにもします
- **アラート分析機能**：生成AIに与えたデータをもとにアラートの分析や対応方針決定をサポートする機能を実装します
- **ツール呼出機能**：生成AI機能だけで完結せず、外部のサービスやデータを参照して問題解決に利用したり、逆にこちらから干渉するような機能を実装します
- **計画実行機能**：生成AIに必要なタスクを事前に計画させたうえで、それを実行するような仕組みを実装します

# おわりに

明日は「小規模SOCチームが直面する現実的課題」と題して、まず生成AIがセキュリティ運用の現場でどのように活用できそうかについて議論していきたいと思います。
